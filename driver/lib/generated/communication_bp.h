// Code generated by bitproto. DO NOT EDIT.

#ifndef __BITPROTO__REAKTOR_DRIVER_H__
#define __BITPROTO__REAKTOR_DRIVER_H__ 1

#include <inttypes.h>
#include <stddef.h>
#include <stdint.h>
#ifndef __cplusplus
#include <stdbool.h>
#endif

#if defined(__cplusplus)
extern "C" {
#endif

#define BITPROTO_OPTIMIZATION_MODE 1

typedef uint8_t Mode; // 3bit

#define DRIVE_MODE_NEUTRAL 0
#define DRIVE_MODE_FORWARD 1
#define DRIVE_MODE_REVERSE 2
#define DRIVE_MODE_PARKING 3
#define DRIVE_MODE_EMERGENCY_STOP 4
// In a heartbeat message, the driver will ignore remaining payload (just a keep-alive message)
#define HEARTBEAT 5
#define UNUSED_B 6
#define UNUSED_C 7

typedef uint8_t ErrorState; // 2bit

#define NO_ERROR 0
#define ERROR 1
#define FATAL_ERROR 3

// Number of bytes to encode struct StatusMessage
#define BYTES_LENGTH_STATUS_MESSAGE 10

struct StatusMessage {
    // // System state
    // If an error occurred an error appendix message will follow directly after this message!
    ErrorState error; // 2bit
    bool remote_control; // 1bit
    // Time since system start in ms. Receiving end must handle overflows
    uint32_t time; // 32bit
    // // Motor control state
    Mode mode; // 3bit
    uint16_t motor_rpm; // 13bit
    uint16_t target_rpm; // 13bit
    // // Internal state
    uint16_t control_rpm; // 13bit
};

// Number of bytes to encode struct ErrorAppendixMessage
#define BYTES_LENGTH_ERROR_APPENDIX_MESSAGE 8

struct ErrorAppendixMessage {
    uint64_t errors; // 64bit
};

// Number of bytes to encode struct ControlMessage
#define BYTES_LENGTH_CONTROL_MESSAGE 2

struct ControlMessage {
    Mode mode; // 3bit
    uint16_t target_rpm; // 13bit
};

// Encode struct StatusMessage to given buffer s.
int EncodeStatusMessage(struct StatusMessage *m, unsigned char *s);
// Decode struct StatusMessage from given buffer s.
int DecodeStatusMessage(struct StatusMessage *m, unsigned char *s);

// Encode struct ErrorAppendixMessage to given buffer s.
int EncodeErrorAppendixMessage(struct ErrorAppendixMessage *m, unsigned char *s);
// Decode struct ErrorAppendixMessage from given buffer s.
int DecodeErrorAppendixMessage(struct ErrorAppendixMessage *m, unsigned char *s);

// Encode struct ControlMessage to given buffer s.
int EncodeControlMessage(struct ControlMessage *m, unsigned char *s);
// Decode struct ControlMessage from given buffer s.
int DecodeControlMessage(struct ControlMessage *m, unsigned char *s);

#if defined(__cplusplus)
}
#endif

#endif